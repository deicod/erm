# erm configuration
module: ""
database:
  url: "postgres://user:pass@localhost:5432/app?sslmode=disable"
  pool:
    max_conns: 20
    min_conns: 4
    max_conn_lifetime: 45m
    max_conn_idle_time: 10m
    health_check_period: 1m
  replicas:
    - name: "reporting-east"
      url: "postgres://user:pass@replica-east:5432/app?sslmode=disable"
      read_only: true
      max_follower_lag: 15s
    - name: "reporting-west"
      url: "postgres://user:pass@replica-west:5432/app?sslmode=disable"
      read_only: true
      max_follower_lag: 30s
  routing:
    default_policy: "reporting"
    policies:
      reporting:
        read_only: true
        max_follower_lag: 20s
      critical-read:
        read_only: true
        max_follower_lag: 5s
        disable_fallback: true
  environments:
    dev:
      url: "postgres://user:pass@localhost:5432/app_dev?sslmode=disable"
    staging:
      url: "postgres://user:pass@staging-db:5432/app_stage?sslmode=disable"
    prod:
      url: "postgres://user:pass@prod-db:5432/app_prod?sslmode=require"
oidc:
  issuer: "https://auth.example.com/realms/app"
  audience: "web-spa"
graphql:
  path: "/graphql"
  subscriptions:
    enabled: true
    broker: inmemory
    transports:
      websocket: true
      graphql_ws: false
extensions:
  postgis: true
  pgvector: true
  timescaledb: false
